{
  "version": 3,
  "sources": ["../src/lib/fraud/client/fraud-detector.ts"],
  "sourcesContent": ["/**\n * Fraud Detector - Client-Side Script\n * \n * Lightweight fingerprinting and behavior tracking library.\n * Replaces Anura's client-side loader.\n * \n * Usage:\n *   const detector = new FraudDetector({\n *     onComplete: (result) => {\n *       if (result.classification === 'GOOD') startCSA();\n *     }\n *   });\n *   detector.analyze();\n */\n\nimport type {\n    FraudDetectorOptions,\n    Fingerprint,\n    BehaviorData,\n    DeviceInfo,\n    ScreenInfo,\n    HardwareInfo,\n    FraudResult,\n    DetectionStage,\n    FraudCheckResponse,\n} from '../types';\n\n// =============================================================================\n// UTILITY FUNCTIONS\n// =============================================================================\n\nfunction generateSessionId(): string {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\n\nasync function hashString(str: string): Promise<string> {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(str);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n}\n\n// =============================================================================\n// DEVICE DETECTION\n// =============================================================================\n\nfunction detectDevice(): DeviceInfo {\n    const ua = navigator.userAgent;\n    const platform = navigator.platform;\n\n    // Mobile detection via User Agent\n    const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n    const isMobileUA = mobileRegex.test(ua);\n\n    // Tablet detection\n    const tabletRegex = /iPad|Android(?=.*\\b(tablet|pad)\\b)|tablet/i;\n    const isTablet = tabletRegex.test(ua) ||\n        (ua.includes('Android') && !ua.includes('Mobile'));\n\n    // Desktop platform detection\n    const desktopPlatforms = ['Win32', 'Win64', 'Windows', 'MacIntel', 'Mac68K', 'Linux x86_64', 'Linux i686'];\n    const isDesktopPlatform = desktopPlatforms.some(p => platform.includes(p));\n\n    // CRITICAL: Fake mobile detection (Chrome DevTools mobile emulation)\n    // This is an INSTANT BAD signal\n    const isFakeMobile = isMobileUA && isDesktopPlatform && !isTablet;\n\n    // Automation detection (Selenium, Puppeteer, Playwright)\n    const isAutomated = (navigator as Navigator & { webdriver?: boolean }).webdriver === true;\n\n    // Headless browser detection\n    const isHeadless = /HeadlessChrome|Headless|PhantomJS|Nightmare/i.test(ua);\n\n    // Parse OS\n    let os = 'unknown';\n    let osVersion = '';\n    if (ua.includes('Windows NT 10')) { os = 'Windows'; osVersion = '10'; }\n    else if (ua.includes('Windows NT 6.3')) { os = 'Windows'; osVersion = '8.1'; }\n    else if (ua.includes('Windows NT 6.1')) { os = 'Windows'; osVersion = '7'; }\n    else if (ua.includes('Mac OS X')) {\n        os = 'macOS';\n        const match = ua.match(/Mac OS X (\\d+[._]\\d+)/);\n        osVersion = match ? match[1].replace('_', '.') : '';\n    }\n    else if (ua.includes('Android')) {\n        os = 'Android';\n        const match = ua.match(/Android (\\d+\\.?\\d*)/);\n        osVersion = match ? match[1] : '';\n    }\n    else if (ua.includes('iPhone') || ua.includes('iPad')) {\n        os = ua.includes('iPad') ? 'iPadOS' : 'iOS';\n        const match = ua.match(/OS (\\d+[._]\\d+)/);\n        osVersion = match ? match[1].replace('_', '.') : '';\n    }\n    else if (ua.includes('Linux')) { os = 'Linux'; }\n\n    // Parse browser\n    let browser = 'unknown';\n    let browserVersion = '';\n    if (ua.includes('Chrome') && !ua.includes('Edg')) {\n        browser = 'Chrome';\n        const match = ua.match(/Chrome\\/(\\d+)/);\n        browserVersion = match ? match[1] : '';\n    } else if (ua.includes('Firefox')) {\n        browser = 'Firefox';\n        const match = ua.match(/Firefox\\/(\\d+)/);\n        browserVersion = match ? match[1] : '';\n    } else if (ua.includes('Safari') && !ua.includes('Chrome')) {\n        browser = 'Safari';\n        const match = ua.match(/Version\\/(\\d+)/);\n        browserVersion = match ? match[1] : '';\n    } else if (ua.includes('Edg')) {\n        browser = 'Edge';\n        const match = ua.match(/Edg\\/(\\d+)/);\n        browserVersion = match ? match[1] : '';\n    }\n\n    // Determine device type\n    let type: DeviceInfo['type'] = 'desktop';\n    if (isAutomated || isHeadless) type = 'bot';\n    else if (isTablet) type = 'tablet';\n    else if (isMobileUA && !isFakeMobile) type = 'mobile';\n\n    return {\n        type,\n        isMobile: type === 'mobile',\n        isTablet: type === 'tablet',\n        isDesktop: type === 'desktop',\n        isFakeMobile,\n        isAutomated,\n        isHeadless,\n        os,\n        osVersion,\n        browser,\n        browserVersion,\n        platform,\n    };\n}\n\nfunction getScreenInfo(): ScreenInfo {\n    return {\n        width: screen.width,\n        height: screen.height,\n        availWidth: screen.availWidth,\n        availHeight: screen.availHeight,\n        colorDepth: screen.colorDepth,\n        pixelRatio: window.devicePixelRatio || 1,\n    };\n}\n\nfunction getHardwareInfo(): HardwareInfo {\n    return {\n        cores: navigator.hardwareConcurrency || 0,\n        // @ts-expect-error - deviceMemory is not in standard types\n        memory: navigator.deviceMemory,\n        maxTouchPoints: navigator.maxTouchPoints || 0,\n        hasTouch: 'ontouchstart' in window || navigator.maxTouchPoints > 0,\n    };\n}\n\n// =============================================================================\n// CANVAS FINGERPRINTING\n// =============================================================================\n\nasync function getCanvasFingerprint(): Promise<string> {\n    try {\n        const canvas = document.createElement('canvas');\n        canvas.width = 200;\n        canvas.height = 50;\n\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return 'canvas-unsupported';\n\n        // Draw complex shapes that vary by GPU\n        ctx.textBaseline = 'top';\n        ctx.font = \"14px 'Arial'\";\n        ctx.fillStyle = '#f60';\n        ctx.fillRect(125, 1, 62, 20);\n        ctx.fillStyle = '#069';\n        ctx.fillText('FraudDetector', 2, 15);\n        ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';\n        ctx.fillText('FraudDetector', 4, 17);\n\n        // Add gradients\n        const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);\n        gradient.addColorStop(0, 'red');\n        gradient.addColorStop(0.5, 'green');\n        gradient.addColorStop(1, 'blue');\n        ctx.fillStyle = gradient;\n        ctx.fillRect(0, 30, 200, 10);\n\n        // Arc\n        ctx.beginPath();\n        ctx.arc(50, 25, 10, 0, Math.PI * 2, true);\n        ctx.closePath();\n        ctx.fill();\n\n        const dataUrl = canvas.toDataURL();\n        return await hashString(dataUrl);\n    } catch {\n        return 'canvas-error';\n    }\n}\n\n// =============================================================================\n// WEBGL FINGERPRINTING\n// =============================================================================\n\ninterface WebGLInfo {\n    vendor: string;\n    renderer: string;\n    hash: string;\n}\n\nasync function getWebGLFingerprint(): Promise<WebGLInfo> {\n    try {\n        const canvas = document.createElement('canvas');\n        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n\n        if (!gl || !(gl instanceof WebGLRenderingContext)) {\n            return { vendor: 'unsupported', renderer: 'unsupported', hash: 'webgl-unsupported' };\n        }\n\n        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\n\n        let vendor = 'unknown';\n        let renderer = 'unknown';\n\n        if (debugInfo) {\n            vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) || 'unknown';\n            renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) || 'unknown';\n        }\n\n        const hash = await hashString(`${vendor}|${renderer}`);\n\n        return { vendor, renderer, hash };\n    } catch {\n        return { vendor: 'error', renderer: 'error', hash: 'webgl-error' };\n    }\n}\n\n// =============================================================================\n// BEHAVIOR TRACKING\n// =============================================================================\n\nclass BehaviorTracker {\n    private data: BehaviorData;\n    private startTime: number;\n    private lastMousePos: { x: number; y: number } | null = null;\n    private listeners: Array<{ type: string; handler: EventListener }> = [];\n\n    constructor(sessionId: string, pageUrl: string) {\n        this.startTime = Date.now();\n        this.data = {\n            mouseMovements: 0,\n            mouseClicks: 0,\n            mouseDistance: 0,\n            touchEvents: 0,\n            touchTaps: 0,\n            touchSwipes: 0,\n            scrollEvents: 0,\n            scrollDistance: 0,\n            keyPresses: 0,\n            activeTime: 0,\n            totalTime: 0,\n            lastEventTime: Date.now(),\n            sessionId,\n            pageUrl,\n        };\n    }\n\n    start(): void {\n        // Mouse movement\n        this.addListener('mousemove', (e: Event) => {\n            const mouseEvent = e as MouseEvent;\n            this.data.mouseMovements++;\n            this.data.lastEventTime = Date.now();\n\n            if (this.lastMousePos) {\n                const dx = mouseEvent.clientX - this.lastMousePos.x;\n                const dy = mouseEvent.clientY - this.lastMousePos.y;\n                this.data.mouseDistance += Math.sqrt(dx * dx + dy * dy);\n            }\n            this.lastMousePos = { x: mouseEvent.clientX, y: mouseEvent.clientY };\n        });\n\n        // Mouse clicks\n        this.addListener('click', () => {\n            this.data.mouseClicks++;\n            this.data.lastEventTime = Date.now();\n        });\n\n        // Touch events\n        this.addListener('touchstart', () => {\n            this.data.touchEvents++;\n            this.data.touchTaps++;\n            this.data.lastEventTime = Date.now();\n        });\n\n        this.addListener('touchmove', () => {\n            this.data.touchEvents++;\n            this.data.lastEventTime = Date.now();\n        });\n\n        this.addListener('touchend', () => {\n            this.data.touchEvents++;\n            this.data.lastEventTime = Date.now();\n        });\n\n        // Scroll events (throttled)\n        let lastScroll = 0;\n        let lastScrollY = window.scrollY;\n        this.addListener('scroll', () => {\n            const now = Date.now();\n            if (now - lastScroll > 100) { // Throttle to 100ms\n                this.data.scrollEvents++;\n                this.data.scrollDistance += Math.abs(window.scrollY - lastScrollY);\n                lastScrollY = window.scrollY;\n                lastScroll = now;\n                this.data.lastEventTime = now;\n            }\n        });\n\n        // Key presses\n        this.addListener('keydown', () => {\n            this.data.keyPresses++;\n            this.data.lastEventTime = Date.now();\n        });\n    }\n\n    private addListener(type: string, handler: EventListener): void {\n        document.addEventListener(type, handler, { passive: true });\n        this.listeners.push({ type, handler });\n    }\n\n    stop(): void {\n        for (const { type, handler } of this.listeners) {\n            document.removeEventListener(type, handler);\n        }\n        this.listeners = [];\n    }\n\n    getData(): BehaviorData {\n        const now = Date.now();\n        this.data.totalTime = now - this.startTime;\n        this.data.activeTime = this.data.lastEventTime - this.startTime;\n        return { ...this.data };\n    }\n}\n\n// =============================================================================\n// MAIN FRAUD DETECTOR CLASS\n// =============================================================================\n\nexport class FraudDetector {\n    private options: Required<FraudDetectorOptions>;\n    private sessionId: string;\n    private behaviorTracker: BehaviorTracker | null = null;\n    private stage: DetectionStage = 'init';\n\n    constructor(options: FraudDetectorOptions) {\n        this.options = {\n            onComplete: options.onComplete,\n            onError: options.onError || (() => { }),\n            onProgress: options.onProgress || (() => { }),\n            apiEndpoint: options.apiEndpoint || '/api/fraud-check',\n            timeout: options.timeout || 5000,\n            collectBehavior: options.collectBehavior !== false,\n            behaviorDuration: options.behaviorDuration || 3000,\n            debug: options.debug || false,\n        };\n\n        this.sessionId = generateSessionId();\n    }\n\n    /**\n     * Start the fraud detection analysis.\n     * This collects fingerprint, tracks behavior, and calls the API.\n     */\n    async analyze(): Promise<void> {\n        try {\n            const startTime = performance.now();\n\n            // Stage 1: Fingerprinting (runs in parallel)\n            this.setStage('fingerprinting');\n            const fingerprint = await this.collectFingerprint();\n\n            // Check for instant BAD signals (no need to continue)\n            if (fingerprint.device.isAutomated || fingerprint.device.isHeadless) {\n                const result: FraudResult = {\n                    classification: 'BAD',\n                    score: 0,\n                    reason: fingerprint.device.isAutomated ? 'Automation detected (webdriver)' : 'Headless browser detected',\n                    timestamp: Date.now(),\n                    processingTime: performance.now() - startTime,\n                };\n                this.setStage('complete');\n                this.options.onComplete(result);\n                return;\n            }\n\n            if (fingerprint.device.isFakeMobile) {\n                const result: FraudResult = {\n                    classification: 'BAD',\n                    score: 0,\n                    reason: 'Fake mobile device detected (emulator)',\n                    timestamp: Date.now(),\n                    processingTime: performance.now() - startTime,\n                };\n                this.setStage('complete');\n                this.options.onComplete(result);\n                return;\n            }\n\n            // Stage 2: Behavior collection (if enabled)\n            let behavior: BehaviorData;\n            if (this.options.collectBehavior) {\n                this.setStage('collecting_behavior');\n                behavior = await this.collectBehavior();\n            } else {\n                behavior = this.getEmptyBehavior();\n            }\n\n            // Stage 3: Send to server for classification\n            this.setStage('sending_request');\n            const result = await this.sendForClassification(fingerprint, behavior);\n\n            result.processingTime = performance.now() - startTime;\n\n            this.setStage('complete');\n            this.options.onComplete(result);\n\n        } catch (error) {\n            this.setStage('error');\n            this.options.onError(error instanceof Error ? error : new Error(String(error)));\n\n            // Fail-safe: On error, return WARN (not BAD) to avoid false positives\n            const result: FraudResult = {\n                classification: 'WARN',\n                score: 50,\n                reason: 'Detection error - defaulting to WARN',\n                timestamp: Date.now(),\n                processingTime: 0,\n            };\n            this.options.onComplete(result);\n        }\n    }\n\n    /**\n     * Start analysis immediately with minimal delay.\n     * Use this when you want fastest possible result.\n     */\n    async analyzeNow(): Promise<FraudResult> {\n        return new Promise((resolve, reject) => {\n            this.options.onComplete = resolve;\n            this.options.onError = reject;\n            this.options.collectBehavior = false; // Skip behavior for speed\n            this.analyze();\n        });\n    }\n\n    private setStage(stage: DetectionStage): void {\n        this.stage = stage;\n        this.options.onProgress(stage);\n        if (this.options.debug) {\n            console.log(`[FraudDetector] Stage: ${stage}`);\n        }\n    }\n\n    private async collectFingerprint(): Promise<Fingerprint> {\n        const device = detectDevice();\n        const screen = getScreenInfo();\n        const hardware = getHardwareInfo();\n\n        // Run canvas and WebGL fingerprinting in parallel\n        const [canvasHash, webglInfo] = await Promise.all([\n            getCanvasFingerprint(),\n            getWebGLFingerprint(),\n        ]);\n\n        // Get plugins (may be empty in modern browsers)\n        const plugins: string[] = [];\n        for (let i = 0; i < navigator.plugins.length; i++) {\n            plugins.push(navigator.plugins[i].name);\n        }\n\n        // Get MIME types\n        const mimeTypes: string[] = [];\n        for (let i = 0; i < navigator.mimeTypes.length; i++) {\n            mimeTypes.push(navigator.mimeTypes[i].type);\n        }\n\n        return {\n            device,\n            screen,\n            hardware,\n            userAgent: navigator.userAgent,\n            language: navigator.language,\n            languages: Array.from(navigator.languages || [navigator.language]),\n            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n            timezoneOffset: new Date().getTimezoneOffset(),\n            canvasHash,\n            webglVendor: webglInfo.vendor,\n            webglRenderer: webglInfo.renderer,\n            webglHash: webglInfo.hash,\n            plugins,\n            mimeTypes,\n            doNotTrack: navigator.doNotTrack,\n            cookiesEnabled: navigator.cookieEnabled,\n            collectedAt: Date.now(),\n        };\n    }\n\n    private collectBehavior(): Promise<BehaviorData> {\n        return new Promise((resolve) => {\n            this.behaviorTracker = new BehaviorTracker(this.sessionId, window.location.href);\n            this.behaviorTracker.start();\n\n            setTimeout(() => {\n                if (this.behaviorTracker) {\n                    const data = this.behaviorTracker.getData();\n                    this.behaviorTracker.stop();\n                    resolve(data);\n                }\n            }, this.options.behaviorDuration);\n        });\n    }\n\n    private getEmptyBehavior(): BehaviorData {\n        return {\n            mouseMovements: 0,\n            mouseClicks: 0,\n            mouseDistance: 0,\n            touchEvents: 0,\n            touchTaps: 0,\n            touchSwipes: 0,\n            scrollEvents: 0,\n            scrollDistance: 0,\n            keyPresses: 0,\n            activeTime: 0,\n            totalTime: 0,\n            lastEventTime: Date.now(),\n            sessionId: this.sessionId,\n            pageUrl: window.location.href,\n        };\n    }\n\n    private async sendForClassification(\n        fingerprint: Fingerprint,\n        behavior: BehaviorData\n    ): Promise<FraudResult> {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), this.options.timeout);\n\n        try {\n            const response = await fetch(this.options.apiEndpoint, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    fingerprint,\n                    behavior,\n                    timestamp: Date.now(),\n                }),\n                signal: controller.signal,\n            });\n\n            clearTimeout(timeoutId);\n\n            if (!response.ok) {\n                throw new Error(`API error: ${response.status}`);\n            }\n\n            const data: FraudCheckResponse = await response.json();\n\n            if (!data.success || !data.result) {\n                throw new Error(data.error || 'Unknown API error');\n            }\n\n            return data.result;\n\n        } catch (error) {\n            clearTimeout(timeoutId);\n            throw error;\n        }\n    }\n\n    /**\n     * Stop behavior tracking early.\n     * Useful if user navigates away.\n     */\n    stopTracking(): void {\n        if (this.behaviorTracker) {\n            this.behaviorTracker.stop();\n        }\n    }\n\n    /**\n     * Get current detection stage.\n     */\n    getStage(): DetectionStage {\n        return this.stage;\n    }\n}\n\n// =============================================================================\n// EXPORT FOR BROWSER (UMD-style)\n// =============================================================================\n\n// Auto-export to window for script tag usage\nif (typeof window !== 'undefined') {\n    (window as unknown as { FraudDetector: typeof FraudDetector }).FraudDetector = FraudDetector;\n}\n\nexport default FraudDetector;\n"],
  "mappings": "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",
  "names": ["fraud_detector_exports", "__export", "FraudDetector", "fraud_detector_default", "generateSessionId", "c", "r", "hashString", "str", "__async", "data", "hashBuffer", "b", "detectDevice", "ua", "platform", "isMobileUA", "isTablet", "isDesktopPlatform", "p", "isFakeMobile", "isAutomated", "isHeadless", "os", "osVersion", "match", "browser", "browserVersion", "type", "getScreenInfo", "getHardwareInfo", "getCanvasFingerprint", "canvas", "ctx", "gradient", "dataUrl", "e", "getWebGLFingerprint", "gl", "debugInfo", "vendor", "renderer", "hash", "BehaviorTracker", "sessionId", "pageUrl", "mouseEvent", "dx", "dy", "lastScroll", "lastScrollY", "now", "handler", "__spreadValues", "FraudDetector", "options", "startTime", "fingerprint", "result", "behavior", "error", "resolve", "reject", "stage", "device", "screen", "hardware", "canvasHash", "webglInfo", "plugins", "i", "mimeTypes", "controller", "timeoutId", "response", "fraud_detector_default"]
}
